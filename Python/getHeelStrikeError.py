import numpy as np

# This function was copied from its MATLAB counterpart.

def getHeelStrikeError(I1,I2,I3,I4,I5,dq1_min,dq2_min,dq3_min,dq4_min,dq5_min,dq1_plus,dq2_plus,dq3_plus,dq4_plus,dq5_plus,l1,l2,l4,l5,lc1,lc2,lc3,lc4,lc5,m1,m2,m3,m4,m5,q1_min,q2_min,q3_min,q4_min,q5_min,q1_plus,q2_plus,q3_plus,q4_plus,q5_plus):

    t2 = I1*dq1_min
    t3 = I2*dq2_min
    t4 = I3*dq3_min
    t5 = I4*dq4_min
    t6 = I2*dq2_plus
    t7 = I3*dq3_plus
    t8 = I4*dq4_plus
    t9 = I5*dq5_plus
    t10 = l1**2
    t11 = l2**2
    t12 = l4**2
    t13 = lc1**2
    t14 = lc2**2
    t15 = lc3**2
    t16 = lc4**2
    t17 = lc5**2
    t18 = -q2_min
    t19 = -q3_min
    t20 = -q4_min
    t21 = -q5_min
    t22 = -q2_plus
    t23 = -q3_plus
    t24 = -q4_plus
    t25 = -q5_plus
    t26 = dq1_min*l1*lc1*m1
    t27 = dq2_min*l2*lc2*m2
    t28 = dq4_min*l4*lc4*m4
    t29 = -t6
    t30 = -t7
    t31 = -t8
    t32 = -t9
    t33 = q1_min+t18
    t34 = q1_min+t19
    t35 = q1_min+t20
    t36 = q2_min+t19
    t37 = q1_min+t21
    t38 = q2_min+t20
    t39 = q2_min+t21
    t40 = q3_min+t20
    t41 = q4_min+t21
    t42 = q1_plus+t22
    t43 = q1_plus+t23
    t44 = q1_plus+t24
    t45 = q2_plus+t23
    t46 = q1_plus+t25
    t47 = q2_plus+t24
    t48 = q2_plus+t25
    t49 = q4_plus+t25
    t50 = dq2_plus*m3*t11
    t51 = dq2_plus*m4*t11
    t52 = dq2_plus*m5*t11
    t53 = dq4_plus*m5*t12
    t54 = dq1_min*m1*t13
    t55 = dq2_min*m2*t14
    t56 = dq3_min*m3*t15
    t57 = dq4_min*m4*t16
    t58 = dq2_plus*m2*t14
    t59 = dq3_plus*m3*t15
    t60 = dq4_plus*m4*t16
    t61 = dq5_plus*m5*t17
    t79 = -t26
    t80 = -t27
    t81 = -t28
    t62 = np.cos(t33)
    t63 = np.cos(t34)
    t64 = np.cos(t35)
    t65 = np.cos(t36)
    t66 = np.cos(t37)
    t67 = np.cos(t38)
    t68 = np.cos(t39)
    t69 = np.cos(t40)
    t70 = np.cos(t41)
    t71 = np.cos(t42)
    t72 = np.cos(t43)
    t73 = np.cos(t44)
    t74 = np.cos(t45)
    t75 = np.cos(t46)
    t76 = np.cos(t47)
    t77 = np.cos(t48)
    t78 = np.cos(t49)
    t82 = -t50
    t83 = -t51
    t84 = -t52
    t85 = -t53
    t86 = -t58
    t87 = -t59
    t88 = -t60
    t89 = -t61
    t90 = dq1_min*l1*l2*m2*t62
    t91 = dq1_min*l1*l4*m2*t64
    t92 = dq1_min*l1*l4*m3*t64
    t93 = dq1_min*l1*l4*m4*t64
    t94 = dq2_min*l2*l4*m3*t67
    t95 = dq2_min*l2*l4*m4*t67
    t96 = dq1_plus*l1*l2*m3*t71
    t97 = dq1_plus*l1*l2*m4*t71
    t98 = dq1_plus*l1*l2*m5*t71
    t99 = dq1_plus*l1*l4*m5*t73
    t100 = dq2_plus*l2*l4*m5*t76
    t101 = dq4_plus*l2*l4*m5*t76
    t102 = dq1_min*l2*lc1*m1*t62
    t103 = dq1_min*l1*lc2*m2*t62
    t104 = dq1_min*l1*lc3*m3*t63
    t105 = dq1_min*l4*lc1*m1*t64
    t106 = dq1_min*l1*lc4*m4*t64
    t107 = dq2_min*l2*lc3*m3*t65
    t108 = dq2_min*l4*lc2*m2*t67
    t109 = dq2_min*l2*lc4*m4*t67
    t110 = dq3_min*l4*lc3*m3*t69
    t111 = dq1_plus*l1*lc2*m2*t71
    t112 = dq1_plus*l1*lc3*m3*t72
    t113 = dq1_plus*l1*lc4*m4*t73
    t114 = dq2_plus*l2*lc3*m3*t74
    t115 = dq3_plus*l2*lc3*m3*t74
    t116 = dq1_plus*l1*lc5*m5*t75
    t117 = dq2_plus*l2*lc4*m4*t76
    t118 = dq4_plus*l2*lc4*m4*t76
    t119 = dq2_plus*l2*lc5*m5*t77
    t120 = dq5_plus*l2*lc5*m5*t77
    t121 = dq4_plus*l4*lc5*m5*t78
    t122 = dq5_plus*l4*lc5*m5*t78
    t123 = -t90
    t124 = -t96
    t125 = -t97
    t126 = -t98
    t127 = -t102
    t128 = -t106
    t129 = -t109
    t130 = -t111
    t131 = -t112
    t132 = -t114
    t133 = -t115
    t134 = -t121
    t135 = -t122
    
    eq_heelStrikeMap = [q1_plus+t21,q2_plus+t20,q3_plus+t19,q4_plus+t18,-q1_min+q5_plus,t2+t3+t4+t5+t29+t30+t31+t32+t54+t55+t56+t57+t79+t80+t81+t82+t83+t84+t85+t86+t87+t88+t89+t91+t92+t93+t94+t95+t99+t100+t101+t103+t104+t105+t107+t108+t110+t113+t116+t117+t118+t119+t120+t123+t124+t125+t126+t127+t128+t129+t130+t131+t132+t133+t134+t135+I5*dq5_min-I1*dq1_plus+dq5_min*m5*t17-dq1_plus*m2*t10-dq1_plus*m3*t10-dq1_plus*m1*t13-dq1_plus*m4*t10-dq1_plus*m5*t10-dq5_min*l5*lc5*m5+dq1_min*l1*l5*m2*t66+dq1_min*l1*l5*m3*t66+dq1_min*l1*l5*m4*t66+dq1_min*l1*l5*m5*t66+dq2_min*l2*l5*m3*t68+dq2_min*l2*l5*m4*t68+dq2_min*l2*l5*m5*t68-dq4_min*l4*l5*m5*t70-dq2_plus*l1*l2*m3*t71-dq2_plus*l1*l2*m4*t71-dq2_plus*l1*l2*m5*t71+dq4_plus*l1*l4*m5*t73+dq1_min*l5*lc1*m1*t66-dq1_min*l1*lc5*m5*t66+dq2_min*l5*lc2*m2*t68-dq2_min*l2*lc5*m5*t68-dq4_min*l5*lc4*m4*t70+dq4_min*l4*lc5*m5*t70-dq2_plus*l1*lc2*m2*t71-dq3_plus*l1*lc3*m3*t72+dq4_plus*l1*lc4*m4*t73+dq5_plus*l1*lc5*m5*t75+dq3_min*l5*lc3*m3*np.cos(q3_min+t21),t2+t3+t4+t5+t29+t30+t31+t32+t54+t55+t56+t57+t79+t80+t81+t82+t83+t84+t85+t86+t87+t88+t89+t91+t92+t93+t94+t95+t99+t100+t101+t103+t104+t105+t107+t108+t110+t113+t116+t117+t118+t119+t120+t123+t124+t125+t126+t127+t128+t129+t130+t131+t132+t133+t134+t135,t2+t3+t4+t30+t31+t32+t54+t55+t56+t79+t80+t85+t87+t88+t89+t99+t100+t103+t104+t107+t113+t116+t117+t119+t123+t127+t131+t132+t134+t135,t2+t3+t31+t32+t54+t55+t79+t80+t85+t88+t89+t99+t100+t103+t113+t116+t117+t119+t123+t127+t134+t135,t2+t32+t54+t79+t89+t116+t119+t134]

    return eq_heelStrikeMap
